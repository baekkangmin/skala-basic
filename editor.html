<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>심플 웹 에디터</title>
  <style>
    body{
      font-family: system-ui, -apple-system, "Apple SD Gothic Neo", "Noto Sans KR", Segoe UI, Roboto, Arial, sans-serif;
      margin: 24px;
      color:#111;
    }
    .container{ max-width: 900px; }

    .toolbar{
      display:flex;
      flex-wrap: wrap;
      gap: 8px;
      align-items:center;
      padding: 10px;
      border: 1px solid #e5e5e5;
      border-radius: 10px;
      background:#fafafa;
    }
    .btn{
      padding: 8px 10px;
      border: 1px solid #ddd;
      background:#fff;
      border-radius: 8px;
      cursor:pointer;
      font-weight: 700;
    }
    .btn:active{ transform: translateY(1px); }
    .btn[aria-pressed="true"]{
      border-color:#bbb;
      background:#f1f1f1;
    }

    .editor{
      margin-top: 12px;
      min-height: 220px;
      padding: 14px;
      border: 1px solid #e5e5e5;
      border-radius: 10px;
      outline: none;
      background:#fff;
      line-height: 1.5;
    }
    .editor:focus{
      border-color:#bdbdbd;
      box-shadow: 0 0 0 3px rgba(0,0,0,0.06);
    }

    .actions{
      margin-top: 12px;
      display:flex;
      gap: 8px;
    }

    .output-wrap{
      margin-top: 18px;
    }
    .output-title{
      font-weight: 800;
      margin: 0 0 8px;
    }
    pre{
      margin:0;
      padding: 14px;
      border-radius: 10px;
      border: 1px solid #e5e5e5;
      background:#0b1020;
      color:#e6e6e6;
      overflow:auto;
      white-space: pre-wrap;
      word-break: break-word;
    }

    input[type="color"]{
      width: 40px;
      height: 34px;
      border: none;
      background: transparent;
      padding: 0;
      cursor: pointer;
    }
    .hint{
      margin-top: 8px;
      color:#666;
      font-size: 13px;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1 style="margin:0 0 12px;">심플 웹 에디터</h1>

    <div class="toolbar">
      <button class="btn" type="button" id="boldBtn" title="굵게 (Ctrl/⌘ + B)"><b>B</b></button>
      <button class="btn" type="button" id="italicBtn" title="기울임 (Ctrl/⌘ + I)"><i>I</i></button>
      <button class="btn" type="button" id="underlineBtn" title="밑줄 (Ctrl/⌘ + U)"><u>U</u></button>

      <span style="width:1px;height:22px;background:#ddd;margin:0 6px;"></span>

      <label style="display:flex;align-items:center;gap:8px;">
        <span style="font-weight:700;">색상</span>
        <input type="color" id="colorPicker" value="#111111" />
      </label>

      <span style="flex:1;"></span>

      <button class="btn" type="button" id="clearBtn" title="서식 제거">서식 제거</button>
    </div>

    <div
      id="editor"
      class="editor"
      contenteditable="true"
      spellcheck="false"
      aria-label="편집 영역"
    >
      여기에 글을 입력하고, 드래그로 선택한 뒤 위 버튼을 눌러 서식을 적용하세요.
    </div>

    <div class="actions">
      <button class="btn" type="button" id="saveBtn">저장(HTML 보기)</button>
      <button class="btn" type="button" id="copyBtn">HTML 복사</button>
    </div>

    <div class="hint">팁: 텍스트 선택 후 굵게/기울임/밑줄/색상 변경을 적용할 수 있습니다.</div>

    <div class="output-wrap">
      <p class="output-title">저장된 HTML</p>
      <pre id="output">&lt;!-- 저장 버튼을 누르면 여기에 HTML이 표시됩니다. --&gt;</pre>
    </div>
  </div>

  <script>
    const editor = document.getElementById("editor");
    const output = document.getElementById("output");

    const boldBtn = document.getElementById("boldBtn");
    const italicBtn = document.getElementById("italicBtn");
    const underlineBtn = document.getElementById("underlineBtn");
    const colorPicker = document.getElementById("colorPicker");

    const saveBtn = document.getElementById("saveBtn");
    const copyBtn = document.getElementById("copyBtn");
    const clearBtn = document.getElementById("clearBtn");

    // 레거시지만 심플 에디터에는 가장 간단한 방식
    function cmd(command, value = null){
      editor.focus();
      document.execCommand(command, false, value);
      updateActiveStates();
    }

    boldBtn.addEventListener("click", () => cmd("bold"));
    italicBtn.addEventListener("click", () => cmd("italic"));
    underlineBtn.addEventListener("click", () => cmd("underline"));

    colorPicker.addEventListener("input", (e) => {
      cmd("foreColor", e.target.value);
    });

    clearBtn.addEventListener("click", () => {
      // 선택 영역이 있으면 서식만 제거됨 (내용 유지)
      cmd("removeFormat");
    });

    // 저장: 편집 영역 innerHTML을 HTML로 출력(이스케이프해서 pre에 표시)
    saveBtn.addEventListener("click", () => {
      const html = editor.innerHTML;
      output.textContent = html; // pre에서 태그가 보이도록 textContent 사용
    });

    // 복사: output에 저장된 HTML을 클립보드로
    copyBtn.addEventListener("click", async () => {
      const html = editor.innerHTML;
      try{
        await navigator.clipboard.writeText(html);
        copyBtn.textContent = "복사됨!";
        setTimeout(() => (copyBtn.textContent = "HTML 복사"), 900);
      }catch{
        // clipboard 권한 문제 대비 fallback
        const ta = document.createElement("textarea");
        ta.value = html;
        document.body.appendChild(ta);
        ta.select();
        document.execCommand("copy");
        document.body.removeChild(ta);
        copyBtn.textContent = "복사됨!";
        setTimeout(() => (copyBtn.textContent = "HTML 복사"), 900);
      }
    });

    // 선택 상태에 따라 버튼 눌림 표시 (대략적인 UX)
    function updateActiveStates(){
      boldBtn.setAttribute("aria-pressed", document.queryCommandState("bold"));
      italicBtn.setAttribute("aria-pressed", document.queryCommandState("italic"));
      underlineBtn.setAttribute("aria-pressed", document.queryCommandState("underline"));
    }

    document.addEventListener("selectionchange", () => {
      // 에디터 밖에서 선택한 경우는 무시
      const sel = document.getSelection();
      if(!sel || sel.rangeCount === 0) return;
      const range = sel.getRangeAt(0);
      if(editor.contains(range.commonAncestorContainer)) updateActiveStates();
    });

    // 초기 버튼 상태
    updateActiveStates();
  </script>
</body>
</html>
